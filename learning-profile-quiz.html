<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learning Profile Quiz - Studying Works</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="apple-style.css">
    <link rel="stylesheet" href="global-styles.css">
    <link rel="stylesheet" href="button-styles.css">
    <style>
        :root {
            --gradient-color-1: #0a0a1a;
            --gradient-color-2: #1e1b4b;
            --gradient-color-3: #134e4a;
        }

        body {
            background: linear-gradient(to bottom right, var(--gradient-color-1), var(--gradient-color-2), var(--gradient-color-3)) fixed !important;
            min-height: 100vh;
        }

        .quiz-card {
            background: linear-gradient(180deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%);
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .quiz-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            border-color: rgba(255,255,255,0.2);
        }
        .option-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
            border: 2px solid rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .option-card:hover {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(168, 85, 247, 0.2) 100%);
            border-color: rgba(59, 130, 246, 0.5);
            transform: translateX(4px);
        }
        .option-card.selected {
            background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
            border-color: rgba(255,255,255,0.3);
            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.4);
        }
        .progress-bar {
            background: linear-gradient(90deg, #3b82f6, #06b6d4, #0ea5e9);
            background-size: 200% 100%;
            animation: gradient-flow 3s ease infinite;
            transition: width 0.3s ease;
            box-shadow: 0 2px 12px rgba(59, 130, 246, 0.5);
        }
        @keyframes gradient-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        .intro-card {
            background: linear-gradient(180deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border: 1px solid rgba(255,255,255,0.15);
            backdrop-filter: blur(20px);
        }
        .privacy-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(14, 165, 164, 0.15) 100%);
            border: 1px solid rgba(59, 130, 246, 0.3);
            backdrop-filter: blur(10px);
        }
        .results-card {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.15) 0%, rgba(59, 130, 246, 0.15) 100%);
            border: 1px solid rgba(168, 85, 247, 0.3);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Breadcrumb Component
        function Breadcrumb({ items }) {
            return (
                <div className="bg-black/20 backdrop-blur-sm border-b border-white/5" style={{ position: 'fixed', top: '0', left: '0', right: '0', zIndex: 50 }}>
                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
                        <nav className="flex items-center space-x-2 text-sm">
                            {items.map((item, index) => (
                                <React.Fragment key={index}>
                                    {index > 0 && (
                                        <svg className="w-4 h-4 text-white/40" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                        </svg>
                                    )}
                                    {item.href ? (
                                        <a
                                            href={item.href}
                                            className="text-white/60 hover:text-white transition-colors"
                                        >
                                            {item.label}
                                        </a>
                                    ) : (
                                        <span className="text-white font-medium">{item.label}</span>
                                    )}
                                </React.Fragment>
                            ))}
                        </nav>
                    </div>
                </div>
            );
        }

        const QUIZ_QUESTIONS = [
            {
                id: 1,
                category: 'learning-style',
                question: 'When learning something new, I prefer to:',
                options: [
                    { text: 'See diagrams, charts, or written instructions', value: 'visual', weight: 3 },
                    { text: 'Listen to someone explain it to me', value: 'auditory', weight: 3 },
                    { text: 'Try it hands-on and learn by doing', value: 'kinesthetic', weight: 3 },
                    { text: 'A combination of the above', value: 'mixed', weight: 1 }
                ]
            },
            {
                id: 2,
                category: 'learning-style',
                question: 'I remember things best when:',
                options: [
                    { text: 'I can see them written down or visualized', value: 'visual', weight: 3 },
                    { text: 'I hear them explained or discussed', value: 'auditory', weight: 3 },
                    { text: 'I physically interact with the material', value: 'kinesthetic', weight: 3 },
                    { text: 'It varies depending on the topic', value: 'mixed', weight: 1 }
                ]
            },
            {
                id: 3,
                category: 'learning-style',
                question: 'When studying, I find it most helpful to:',
                options: [
                    { text: 'Use color-coded notes, mind maps, or flashcards', value: 'visual', weight: 2 },
                    { text: 'Read aloud or discuss with others', value: 'auditory', weight: 2 },
                    { text: 'Take breaks to move around or use physical objects', value: 'kinesthetic', weight: 2 },
                    { text: 'Mix different approaches', value: 'mixed', weight: 1 }
                ]
            },
            {
                id: 4,
                category: 'focus',
                question: 'When trying to focus on studying or work, I:',
                options: [
                    { text: 'Can concentrate easily for long periods', value: 'none', weight: 0 },
                    { text: 'Sometimes get distracted but can refocus quickly', value: 'mild', weight: 1 },
                    { text: 'Often find my mind wandering or feel restless', value: 'moderate', weight: 2 },
                    { text: 'Have significant difficulty staying focused', value: 'high', weight: 3 }
                ]
            },
            {
                id: 5,
                category: 'focus',
                question: 'I work best in an environment that is:',
                options: [
                    { text: 'Completely quiet with minimal distractions', value: 'high', weight: 2 },
                    { text: 'With some background noise or activity', value: 'mild', weight: 1 },
                    { text: 'Busy and stimulating', value: 'none', weight: 0 },
                    { text: 'It depends on the task', value: 'moderate', weight: 1 }
                ]
            },
            {
                id: 6,
                category: 'reading',
                question: 'When reading text, I:',
                options: [
                    { text: 'Read smoothly without issues', value: 'none', weight: 0 },
                    { text: 'Sometimes mix up similar-looking letters or words', value: 'mild', weight: 1 },
                    { text: 'Often need to re-read sentences to understand them', value: 'moderate', weight: 2 },
                    { text: 'Find reading tiring and frequently lose my place', value: 'high', weight: 3 }
                ]
            },
            {
                id: 7,
                category: 'reading',
                question: 'When encountering unfamiliar words, I:',
                options: [
                    { text: 'Can usually sound them out easily', value: 'none', weight: 0 },
                    { text: 'Sometimes struggle with pronunciation', value: 'mild', weight: 1 },
                    { text: 'Often have difficulty reading unfamiliar words', value: 'moderate', weight: 2 },
                    { text: 'Prefer listening to text rather than reading it', value: 'high', weight: 3 }
                ]
            },
            {
                id: 8,
                category: 'processing',
                question: 'When given multiple instructions, I:',
                options: [
                    { text: 'Can remember and follow them all easily', value: 'none', weight: 0 },
                    { text: 'Need to hear them repeated or written down', value: 'mild', weight: 1 },
                    { text: 'Often forget some steps if not written down', value: 'moderate', weight: 2 },
                    { text: 'Need instructions broken down into single steps', value: 'high', weight: 3 }
                ]
            },
            {
                id: 9,
                category: 'processing',
                question: 'When solving problems or learning new concepts, I:',
                options: [
                    { text: 'Grasp them quickly', value: 'none', weight: 0 },
                    { text: 'Need a bit of extra time to process', value: 'mild', weight: 1 },
                    { text: 'Require more time and repetition than others', value: 'moderate', weight: 2 },
                    { text: 'Benefit from step-by-step explanations', value: 'high', weight: 2 }
                ]
            },
            {
                id: 10,
                category: 'memory',
                question: 'When trying to remember information, I:',
                options: [
                    { text: 'Can recall it easily', value: 'none', weight: 0 },
                    { text: 'Sometimes need prompts or cues', value: 'mild', weight: 1 },
                    { text: 'Often need to review material multiple times', value: 'moderate', weight: 2 },
                    { text: 'Find it challenging even with repeated study', value: 'high', weight: 3 }
                ]
            },
            {
                id: 11,
                category: 'organization',
                question: 'When organizing my study materials or tasks, I:',
                options: [
                    { text: 'Keep everything well-organized naturally', value: 'none', weight: 0 },
                    { text: 'Try to stay organized but sometimes slip', value: 'mild', weight: 1 },
                    { text: 'Often feel overwhelmed by organizing', value: 'moderate', weight: 2 },
                    { text: 'Struggle significantly with keeping things organized', value: 'high', weight: 3 }
                ]
            },
            {
                id: 12,
                category: 'time-management',
                question: 'When estimating how long a task will take, I:',
                options: [
                    { text: 'Am usually accurate', value: 'none', weight: 0 },
                    { text: 'Sometimes misjudge the time needed', value: 'mild', weight: 1 },
                    { text: 'Often underestimate or lose track of time', value: 'moderate', weight: 2 },
                    { text: 'Frequently struggle with time management', value: 'high', weight: 3 }
                ]
            }
        ];

        function LearningProfileQuiz({ onComplete, isRetake = false }) {
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [answers, setAnswers] = useState({});
            const [showIntro, setShowIntro] = useState(!isRetake);
            const [showResults, setShowResults] = useState(false);
            const [showRecommendations, setShowRecommendations] = useState(false);
            const [profile, setProfile] = useState(null);
            const [selectedPreferences, setSelectedPreferences] = useState({});

            const handleAnswer = (questionId, optionValue, weight, category) => {
                const newAnswers = {
                    ...answers,
                    [questionId]: { value: optionValue, weight, category }
                };
                setAnswers(newAnswers);

                // Auto-advance to next question
                setTimeout(() => {
                    if (currentQuestion < QUIZ_QUESTIONS.length - 1) {
                        setCurrentQuestion(currentQuestion + 1);
                    } else {
                        calculateProfile(newAnswers);
                    }
                }, 300);
            };

            const calculateProfile = (finalAnswers) => {
                const scores = {
                    visual: 0,
                    auditory: 0,
                    kinesthetic: 0,
                    mixed: 0,
                    focus: 0,
                    reading: 0,
                    processing: 0,
                    memory: 0,
                    organization: 0,
                    timeManagement: 0
                };

                Object.values(finalAnswers).forEach(answer => {
                    const { value, weight, category } = answer;

                    if (category === 'learning-style') {
                        scores[value] += weight;
                    } else if (category === 'focus') {
                        if (value !== 'none') scores.focus += weight;
                    } else if (category === 'reading') {
                        if (value !== 'none') scores.reading += weight;
                    } else if (category === 'processing') {
                        if (value !== 'none') scores.processing += weight;
                    } else if (category === 'memory') {
                        if (value !== 'none') scores.memory += weight;
                    } else if (category === 'organization') {
                        if (value !== 'none') scores.organization += weight;
                    } else if (category === 'time-management') {
                        if (value !== 'none') scores.timeManagement += weight;
                    }
                });

                // Determine primary learning style
                let primaryStyle = 'visual';
                let maxStyleScore = scores.visual;

                if (scores.auditory > maxStyleScore) {
                    primaryStyle = 'auditory';
                    maxStyleScore = scores.auditory;
                }
                if (scores.kinesthetic > maxStyleScore) {
                    primaryStyle = 'kinesthetic';
                    maxStyleScore = scores.kinesthetic;
                }
                if (scores.mixed > maxStyleScore) {
                    primaryStyle = 'mixed';
                }

                // Determine learning challenges (threshold of 2+ for mild, 4+ for moderate, 6+ for high)
                const challenges = [];
                if (scores.focus >= 2) challenges.push({ type: 'focus', level: scores.focus >= 5 ? 'high' : scores.focus >= 3 ? 'moderate' : 'mild' });
                if (scores.reading >= 2) challenges.push({ type: 'reading', level: scores.reading >= 5 ? 'high' : scores.reading >= 3 ? 'moderate' : 'mild' });
                if (scores.processing >= 2) challenges.push({ type: 'processing', level: scores.processing >= 5 ? 'high' : scores.processing >= 3 ? 'moderate' : 'mild' });
                if (scores.memory >= 2) challenges.push({ type: 'memory', level: scores.memory >= 5 ? 'high' : scores.memory >= 3 ? 'moderate' : 'mild' });
                if (scores.organization >= 2) challenges.push({ type: 'organization', level: scores.organization >= 5 ? 'high' : scores.organization >= 3 ? 'moderate' : 'mild' });
                if (scores.timeManagement >= 2) challenges.push({ type: 'timeManagement', level: scores.timeManagement >= 5 ? 'high' : scores.timeManagement >= 3 ? 'moderate' : 'mild' });

                const newProfile = {
                    learningStyle: primaryStyle,
                    styleScores: {
                        visual: scores.visual,
                        auditory: scores.auditory,
                        kinesthetic: scores.kinesthetic,
                        mixed: scores.mixed
                    },
                    challenges,
                    dateCompleted: new Date().toISOString()
                };

                setProfile(newProfile);
                saveProfile(newProfile);
                setShowResults(true);
            };

            const saveProfile = (profileData) => {
                try {
                    localStorage.setItem('learningProfile', JSON.stringify(profileData));
                    console.log('Learning profile saved to local storage');
                } catch (error) {
                    console.error('Error saving learning profile:', error);
                }
            };

            const getChallengeDescription = (challenge) => {
                const descriptions = {
                    focus: 'Focus & concentration',
                    reading: 'Reading & comprehension',
                    processing: 'Learning pace',
                    memory: 'Memory & retention',
                    organization: 'Organization & planning',
                    timeManagement: 'Time management'
                };
                return descriptions[challenge.type] || challenge.type;
            };

            const getStyleIcon = (style) => {
                const icons = {
                    visual: 'fa-eye',
                    auditory: 'fa-ear-listen',
                    kinesthetic: 'fa-hand',
                    mixed: 'fa-layer-group'
                };
                return icons[style] || 'fa-user';
            };

            const getStyleDescription = (style) => {
                const descriptions = {
                    visual: 'You learn best through seeing - diagrams, charts, written materials, and visual aids help you understand and retain information.',
                    auditory: 'You learn best through listening - verbal explanations, discussions, and audio materials are most effective for you.',
                    kinesthetic: 'You learn best through doing - hands-on activities, physical movement, and practical application help you understand.',
                    mixed: 'You benefit from a variety of learning approaches - using multiple methods helps you learn most effectively.'
                };
                return descriptions[style] || '';
            };

            const getSettingInfo = (settingKey) => {
                const settingDescriptions = {
                    enableTextToSpeech: {
                        title: 'Text-to-Speech',
                        description: 'Hear questions and content read aloud',
                        icon: 'fa-volume-up',
                        benefit: 'Great for auditory learners and makes reading easier'
                    },
                    showVisualAids: {
                        title: 'Visual Enhancements',
                        description: 'Color-coded borders and visual indicators',
                        icon: 'fa-palette',
                        benefit: 'Helps visual learners identify and remember content'
                    },
                    largerFonts: {
                        title: 'Larger Text',
                        description: 'Increased font sizes for better readability',
                        icon: 'fa-text-height',
                        benefit: 'Reduces eye strain and makes reading more comfortable'
                    },
                    reduceAnimations: {
                        title: 'Reduced Motion',
                        description: 'Minimize animations and transitions',
                        icon: 'fa-rabbit',
                        benefit: 'Less distraction and easier focus on content'
                    },
                    distractionFreeMode: {
                        title: 'Focus Mode',
                        description: 'Simplified interface with fewer distractions',
                        icon: 'fa-bullseye',
                        benefit: 'Helps maintain concentration on your studies'
                    },
                    enableSpacedRepetition: {
                        title: 'Spaced Repetition',
                        description: 'Review material at optimal intervals',
                        icon: 'fa-calendar-check',
                        benefit: 'Scientifically proven to improve long-term memory'
                    },
                    enableBreakReminders: {
                        title: 'Break Reminders',
                        description: 'Gentle nudges to take regular breaks',
                        icon: 'fa-clock',
                        benefit: 'Prevents burnout and maintains productivity'
                    },
                    showStepByStep: {
                        title: 'Step-by-Step Guidance',
                        description: 'Break down complex problems into smaller steps',
                        icon: 'fa-stairs',
                        benefit: 'Makes challenging material more manageable'
                    }
                };
                return settingDescriptions[settingKey] || { title: settingKey, description: '', icon: 'fa-cog', benefit: '' };
            };

            const togglePreference = (key) => {
                setSelectedPreferences(prev => ({
                    ...prev,
                    [key]: !prev[key]
                }));
            };

            const applySelectedPreferences = () => {
                try {
                    localStorage.setItem('userPreferences', JSON.stringify(selectedPreferences));
                    console.log('User preferences saved');
                    if (onComplete) onComplete(profile);
                    else window.location.href = '/dashboard.html';
                } catch (error) {
                    console.error('Error saving preferences:', error);
                }
            };

            if (showIntro) {
                return (
                    <>
                        <Breadcrumb items={[
                            { label: 'Dashboard', href: 'dashboard' },
                            { label: 'Learning Profile Quiz' }
                        ]} />
                        <div className="min-h-screen flex items-center justify-center p-4" style={{ paddingTop: '70px' }}>
                        <div className="max-w-2xl w-full intro-card rounded-2xl shadow-2xl p-8">
                            <div className="text-center mb-6">
                                <i className="fas fa-brain text-6xl mb-4" style={{color: '#06b6d4'}}></i>
                                <h1 className="text-3xl font-bold text-white mb-2">Welcome to Your Learning Profile Quiz</h1>
                                <p className="text-gray-300">Let's personalize your learning experience!</p>
                            </div>

                            <div className="privacy-card rounded-xl p-6 mb-6">
                                <h2 className="text-lg font-semibold text-white mb-3 flex items-center">
                                    <i className="fas fa-shield-halved mr-2"></i>
                                    Your Privacy Matters
                                </h2>
                                <ul className="text-sm text-blue-200 space-y-2">
                                    <li className="flex items-start">
                                        <i className="fas fa-check-circle mt-1 mr-2 text-blue-400"></i>
                                        <span>All your responses are stored <strong>locally on your device only</strong></span>
                                    </li>
                                    <li className="flex items-start">
                                        <i className="fas fa-check-circle mt-1 mr-2 text-blue-400"></i>
                                        <span>No data is uploaded to any server or shared with anyone</span>
                                    </li>
                                    <li className="flex items-start">
                                        <i className="fas fa-check-circle mt-1 mr-2 text-blue-400"></i>
                                        <span>You can retake or delete this profile anytime from Settings</span>
                                    </li>
                                </ul>
                            </div>

                            <div className="space-y-4 mb-6">
                                <h3 className="font-semibold text-white">This quiz will help us understand:</h3>
                                <ul className="space-y-2 text-gray-200">
                                    <li className="flex items-center">
                                        <i className="fas fa-palette mr-3 text-purple-400"></i>
                                        Your preferred learning style (Visual, Auditory, or Kinesthetic)
                                    </li>
                                    <li className="flex items-center">
                                        <i className="fas fa-wrench mr-3 text-green-400"></i>
                                        How we can best support your learning needs
                                    </li>
                                    <li className="flex items-center">
                                        <i className="fas fa-star mr-3 text-yellow-400"></i>
                                        Which study tools and features to recommend for you
                                    </li>
                                </ul>
                            </div>

                            <div className="text-center text-sm text-gray-300 mb-6">
                                <p>This will take about 3-5 minutes. Answer honestly - there are no wrong answers!</p>
                            </div>

                            <button
                                onClick={() => setShowIntro(false)}
                                className="w-full card-gradient-blue text-white font-bold py-3 px-6 rounded-lg transition duration-200 hover:scale-105"
                            >
                                Start Quiz <i className="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                    </div>
                    </>
                );
            }

            // Helper function to get recommended settings based on profile
            const getRecommendedSettingsFromProfile = (profileData) => {
                const recommended = [];

                // Based on learning style
                if (profileData.learningStyle === 'auditory') {
                    recommended.push('enableTextToSpeech');
                }
                if (profileData.learningStyle === 'visual') {
                    recommended.push('showVisualAids');
                }
                if (profileData.learningStyle === 'kinesthetic') {
                    recommended.push('enableBreakReminders');
                }

                // Based on challenges
                if (profileData.challenges) {
                    profileData.challenges.forEach(challenge => {
                        if (challenge.type === 'reading') {
                            recommended.push('largerFonts');
                            if (!recommended.includes('enableTextToSpeech')) {
                                recommended.push('enableTextToSpeech');
                            }
                        }
                        if (challenge.type === 'focus' && (challenge.level === 'moderate' || challenge.level === 'high')) {
                            recommended.push('reduceAnimations');
                            recommended.push('distractionFreeMode');
                        }
                        if (challenge.type === 'memory') {
                            recommended.push('enableSpacedRepetition');
                        }
                        if (challenge.type === 'processing') {
                            recommended.push('showStepByStep');
                        }
                    });
                }

                return recommended;
            };

            // Show recommendations screen
            if (showRecommendations && profile) {
                const recommendedSettings = getRecommendedSettingsFromProfile(profile);

                return (
                    <div className="min-h-screen p-4">
                        <div className="max-w-4xl mx-auto py-8">
                            <div className="results-card rounded-2xl shadow-2xl p-8 mb-6">
                                <div className="text-center mb-8">
                                    <i className="fas fa-sliders-h text-6xl text-purple-400 mb-4"></i>
                                    <h1 className="text-3xl font-bold text-white mb-2">Optional Features for You</h1>
                                    <p className="text-gray-300">Based on your learning profile, these features might enhance your experience.</p>
                                    <p className="text-sm text-gray-400 mt-2">You can enable any, all, or none - it's completely up to you!</p>
                                </div>

                                <div className="space-y-4 mb-8">
                                    {recommendedSettings.map((settingKey) => {
                                        const setting = getSettingInfo(settingKey);
                                        const isSelected = selectedPreferences[settingKey] || false;

                                        return (
                                            <div
                                                key={settingKey}
                                                onClick={() => togglePreference(settingKey)}
                                                className={`cursor-pointer rounded-lg p-5 border-2 transition-all duration-200 ${
                                                    isSelected
                                                        ? 'bg-gradient-to-r from-blue-500/30 to-purple-500/30 border-blue-400 shadow-lg'
                                                        : 'bg-white/5 border-white/20 hover:border-white/40 hover:bg-white/10'
                                                }`}
                                            >
                                                <div className="flex items-start">
                                                    <div className="flex-shrink-0 mr-4">
                                                        <div className={`w-12 h-12 rounded-full flex items-center justify-center ${
                                                            isSelected ? 'bg-blue-500' : 'bg-white/10'
                                                        }`}>
                                                            <i className={`fas ${setting.icon} text-xl text-white`}></i>
                                                        </div>
                                                    </div>
                                                    <div className="flex-1">
                                                        <div className="flex items-center justify-between mb-2">
                                                            <h3 className="text-lg font-semibold text-white">{setting.title}</h3>
                                                            <div className={`w-6 h-6 rounded border-2 flex items-center justify-center ${
                                                                isSelected ? 'bg-blue-500 border-blue-500' : 'border-white/40'
                                                            }`}>
                                                                {isSelected && <i className="fas fa-check text-white text-sm"></i>}
                                                            </div>
                                                        </div>
                                                        <p className="text-gray-300 text-sm mb-1">{setting.description}</p>
                                                        <p className="text-blue-300 text-xs italic">{setting.benefit}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>

                                <div className="bg-purple-500/20 border border-purple-400/40 rounded-lg p-5 mb-6 backdrop-blur-sm">
                                    <p className="text-purple-100 text-sm flex items-start">
                                        <i className="fas fa-info-circle mr-2 mt-1"></i>
                                        <span>These are just suggestions based on your preferences. You can always change these later in Settings, or try them out and see what works best for you!</span>
                                    </p>
                                </div>

                                <div className="flex gap-4">
                                    <button
                                        onClick={applySelectedPreferences}
                                        className="flex-1 card-gradient-blue text-white font-bold py-3 px-6 rounded-lg transition duration-200 hover:scale-105"
                                    >
                                        <i className="fas fa-check mr-2"></i>
                                        {Object.values(selectedPreferences).filter(v => v).length > 0
                                            ? `Apply ${Object.values(selectedPreferences).filter(v => v).length} Selected`
                                            : 'Continue Without Features'}
                                    </button>
                                    <button
                                        onClick={() => setShowRecommendations(false)}
                                        className="bg-white/10 hover:bg-white/20 border border-white/20 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 hover:scale-105"
                                    >
                                        <i className="fas fa-arrow-left mr-2"></i>
                                        Back
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (showResults && profile) {
                return (
                    <div className="min-h-screen p-4">
                        <div className="max-w-4xl mx-auto py-8">
                            <div className="results-card rounded-2xl shadow-2xl p-8 mb-6">
                                <div className="text-center mb-8">
                                    <i className="fas fa-check-circle text-6xl text-green-400 mb-4"></i>
                                    <h1 className="text-3xl font-bold text-white mb-2">Your Learning Profile is Ready!</h1>
                                    <p className="text-gray-300">We've personalized your experience based on your responses</p>
                                </div>

                                <div className="mb-8">
                                    <h2 className="text-2xl font-bold text-white mb-4 flex items-center">
                                        <i className={`fas ${getStyleIcon(profile.learningStyle)} mr-3 text-blue-400`}></i>
                                        Your Learning Style: {profile.learningStyle.charAt(0).toUpperCase() + profile.learningStyle.slice(1)}
                                    </h2>
                                    <p className="text-gray-200 mb-4">{getStyleDescription(profile.learningStyle)}</p>

                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                        {Object.entries(profile.styleScores).map(([style, score]) => (
                                            <div key={style} className="bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg p-4 text-center">
                                                <i className={`fas ${getStyleIcon(style)} text-2xl mb-2 ${profile.learningStyle === style ? 'text-blue-400' : 'text-gray-400'}`}></i>
                                                <div className="font-semibold text-white capitalize">{style}</div>
                                                <div className="text-sm text-gray-300">Score: {score}</div>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                {profile.challenges && profile.challenges.length > 0 && (
                                    <div className="mb-8">
                                        <h2 className="text-2xl font-bold text-white mb-4 flex items-center">
                                            <i className="fas fa-star mr-3 text-purple-400"></i>
                                            Your Learning Preferences
                                        </h2>
                                        <p className="text-gray-200 mb-4">We have optional features available for:</p>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            {profile.challenges.map((challenge, index) => (
                                                <div key={index} className="bg-purple-500/20 border border-purple-400/40 rounded-lg p-4 backdrop-blur-sm">
                                                    <div className="flex items-center justify-between">
                                                        <span className="font-semibold text-white">{getChallengeDescription(challenge)}</span>
                                                        <span className="text-xs bg-purple-600 text-white px-2 py-1 rounded-full capitalize">
                                                            {challenge.level}
                                                        </span>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                <div className="bg-blue-500/20 border border-blue-400/40 rounded-lg p-6 mb-6 backdrop-blur-sm">
                                    <h3 className="font-semibold text-white mb-3 flex items-center">
                                        <i className="fas fa-lightbulb mr-2"></i>
                                        What's Next?
                                    </h3>
                                    <p className="text-blue-100 mb-3">
                                        Based on your responses, we have some optional features you might find helpful. You're in control - choose what works for you!
                                    </p>
                                    <ul className="text-sm text-blue-100 space-y-2">
                                        <li className="flex items-start">
                                            <i className="fas fa-check mr-2 mt-1 text-blue-400"></i>
                                            <span>You'll see <strong>"Recommended"</strong> badges on study modes that match your learning style</span>
                                        </li>
                                        <li className="flex items-start">
                                            <i className="fas fa-check mr-2 mt-1 text-blue-400"></i>
                                            <span>You can customize your experience with optional features</span>
                                        </li>
                                        <li className="flex items-start">
                                            <i className="fas fa-check mr-2 mt-1 text-blue-400"></i>
                                            <span>You can adjust or retake this quiz anytime from Settings</span>
                                        </li>
                                    </ul>
                                </div>

                                <div className="flex gap-4">
                                    <button
                                        onClick={() => setShowRecommendations(true)}
                                        className="flex-1 card-gradient-blue text-white font-bold py-3 px-6 rounded-lg transition duration-200 hover:scale-105"
                                    >
                                        <i className="fas fa-magic mr-2"></i>
                                        View Recommended Features
                                    </button>
                                    <button
                                        onClick={() => {
                                            // Save empty preferences (nothing enabled by default)
                                            localStorage.setItem('userPreferences', JSON.stringify({}));
                                            if (onComplete) onComplete(profile);
                                            else window.location.href = '/dashboard.html';
                                        }}
                                        className="flex-1 bg-white/10 hover:bg-white/20 border border-white/20 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 hover:scale-105"
                                    >
                                        <i className="fas fa-arrow-right mr-2"></i>
                                        Skip to Dashboard
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            const question = QUIZ_QUESTIONS[currentQuestion];
            const progress = ((currentQuestion + 1) / QUIZ_QUESTIONS.length) * 100;

            return (
                <div className="min-h-screen p-4">
                    <div className="max-w-3xl mx-auto py-8">
                        <div className="mb-6">
                            <div className="flex justify-between items-center mb-2">
                                <span className="text-sm font-semibold text-white">
                                    Question {currentQuestion + 1} of {QUIZ_QUESTIONS.length}
                                </span>
                                <span className="text-sm text-gray-300">{Math.round(progress)}% Complete</span>
                            </div>
                            <div className="w-full bg-white/10 rounded-full h-2">
                                <div
                                    className="progress-bar h-2 rounded-full"
                                    style={{ width: `${progress}%` }}
                                ></div>
                            </div>
                        </div>

                        <div className="quiz-card rounded-2xl shadow-2xl p-8">
                            <h2 className="text-2xl font-bold text-white mb-6">{question.question}</h2>

                            <div className="space-y-3">
                                {question.options.map((option, index) => (
                                    <div
                                        key={index}
                                        onClick={() => handleAnswer(question.id, option.value, option.weight, question.category)}
                                        className={`option-card rounded-xl p-4 ${
                                            answers[question.id]?.value === option.value ? 'selected' : ''
                                        }`}
                                    >
                                        <div className="flex items-center">
                                            <div className="flex-shrink-0 w-8 h-8 rounded-full bg-white/20 flex items-center justify-center mr-4">
                                                <span className="font-semibold text-white">{String.fromCharCode(65 + index)}</span>
                                            </div>
                                            <span className="text-white">{option.text}</span>
                                        </div>
                                    </div>
                                ))}
                            </div>

                            {currentQuestion > 0 && (
                                <button
                                    onClick={() => setCurrentQuestion(currentQuestion - 1)}
                                    className="mt-6 text-gray-300 hover:text-white font-semibold transition"
                                >
                                    <i className="fas fa-arrow-left mr-2"></i>
                                    Previous Question
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        function App() {
            return <LearningProfileQuiz />;
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
